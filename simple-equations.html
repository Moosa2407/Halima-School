<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø­Ù„ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø© â€” 30 Ø³Ø¤Ø§Ù„ / 180 Ø«Ø§Ù†ÙŠØ©</title>
  <style>
    :root{ --bg:#f8f6fb; --ink:#111827; --muted:#6b7280; --border:#e5e7eb;
           --panel:#fff; --panel2:#faf5ff; --accent:#7c3aed; --ok:#16a34a; --bad:#dc2626; }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font-family:"Segoe UI",Tahoma,Arial,sans-serif}
    .wrap{max-width:1100px;margin:auto;padding:20px}
    header{text-align:center}
    h1{margin:8px 0 4px}
    .subtitle{color:var(--muted)}
    .status{display:flex;justify-content:space-between;gap:10px;background:var(--panel2);
            border:1px solid var(--border);padding:10px;border-radius:12px;margin-top:12px}
    .chip{font-weight:700;padding:8px 12px;border-radius:10px;background:#e0e7ff}
    .chip.time{background:#ffe4e6}
    .card{margin-top:16px;background:var(--panel);border:1px solid var(--border);
          border-radius:14px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.05)}
    .qbar{background:#ede9fe;border:1px solid #ddd6fe;border-radius:10px;padding:14px;margin-bottom:12px}
    .qbar h2{margin:0;text-align:center;font-size:clamp(18px,3.6vw,26px)}
    .big{font-size:26px;font-weight:800;text-align:center}
    .choices{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:16px}
    .choice{background:#fff;border:1px solid var(--border);border-radius:10px;padding:10px 16px;cursor:pointer;min-width:120px;font-weight:700}
    .choice:hover{filter:brightness(.98)}
    .choice.correct{background:#ecfdf5;border-color:#bbf7d0}
    .choice.wrong{background:#fef2f2;border-color:#fecaca}
    .actions{display:flex;justify-content:center;margin-top:10px}
    .btn{border:1px solid var(--border);background:#eef2ff;border-radius:10px;padding:10px 16px;cursor:pointer}
    .note{color:var(--muted);text-align:center;margin-top:6px}
    footer{margin-top:18px;text-align:center;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Ø­Ù„ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø©</h1>
      <p class="subtitle">ØªÙ…Ø±ÙŠÙ† Ø¹Ù„Ù‰ Ù…ÙˆØ§Ø²Ù†Ø© Ø§Ù„Ø·Ø±ÙÙŠÙ† ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¹ÙƒØ³ÙŠØ© Ù„Ø­Ù„ Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ù…Ù† Ø®Ø·ÙˆØ© Ø£Ùˆ Ø®Ø·ÙˆØªÙŠÙ†. Ù„Ø¯ÙŠÙƒ 180 Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ 30 Ø³Ø¤Ø§Ù„Ù‹Ø§. Ø¥Ø°Ø§ Ø£Ø®Ø·Ø£Øª ÙØ³ØªØ¹ÙˆØ¯ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©.</p>
    </header>

    <div class="status">
      <div class="chip">Ø§Ù„Ø³Ø¤Ø§Ù„: <span id="counter">0 / 30</span></div>
      <div class="chip">Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score">0</span></div>
      <div class="chip time">â° Ø§Ù„ÙˆÙ‚Øª: <span id="time">180</span> Ø«Ø§Ù†ÙŠØ©</div>
    </div>

    <section class="card">
      <div class="qbar"><h2 id="question">Ø£ÙˆØ¬Ø¯ Ù‚ÙŠÙ…Ø© x:</h2></div>
      <div class="big" id="eqBox">Ø§Ø¶ØºØ·/ÙŠ Ø§Ø¨Ø¯Ø£ Ù„Ù„Ø§Ù†Ø·Ù„Ø§Ù‚!</div>
      <p class="note" id="hint"></p>
      <div class="choices" id="choices"></div>
      <div class="actions"><button class="btn" id="startBtn">Ø§Ø¨Ø¯Ø£ â–¶ï¸</button></div>
    </section>

    <footer id="done" hidden>Ø£Ø­Ø³Ù†Øª! Ø§ÙƒØªÙ…Ù„Øª Ø§Ù„Ù…Ù‡Ù…Ø© ğŸ‰</footer>
  </div>

<script>
/* Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª */
const TIME_LIMIT = 180;
const TOTAL_Q = 30;

/* Ø¹Ù†Ø§ØµØ± */
const counterEl = document.getElementById('counter');
const scoreEl   = document.getElementById('score');
const timeEl    = document.getElementById('time');
const eqEl      = document.getElementById('eqBox');
const hintEl    = document.getElementById('hint');
const choicesEl = document.getElementById('choices');
const startBtn  = document.getElementById('startBtn');
const doneEl    = document.getElementById('done');

/* Ù…Ø³Ø§Ø¹Ø¯Ø§Øª */
const rnd = (a,b)=> Math.floor(Math.random()*(b-a+1))+a;
function makeChoices(correct){
  const s = new Set([correct]);
  while(s.size<3){
    const delta = rnd(1,3)*(Math.random()<.5?-1:1);
    s.add(correct+delta);
  }
  return [...s].sort(()=>Math.random()-0.5).map(String);
}
const asEq = s => s.replace(/\*/g,'Â·');

/* Ù…ÙˆÙ„Ø¯Ø§Øª */
function gen_add_sub(){ // Ø³Ù‡Ù„
  const a = rnd(1,12), x = rnd(0,20);
  if(Math.random()<0.5){ const b=x+a; return {eq:`x + ${a} = ${b}`, ans:x, hint:'Ø§Ø·Ø±Ø­ Ù†ÙØ³ Ø§Ù„Ø¹Ø¯Ø¯ Ù…Ù† Ø§Ù„Ø·Ø±ÙÙŠÙ†.'}; }
  const b = x-a; return {eq:`x âˆ’ ${a} = ${b}`, ans:x, hint:'Ø£Ø¶Ù Ù†ÙØ³ Ø§Ù„Ø¹Ø¯Ø¯ Ù„Ù„Ø·Ø±ÙÙŠÙ†.'};
}
function gen_mul_div(){ // Ø³Ù‡Ù„
  const a=rnd(2,9), x=rnd(1,12);
  if(Math.random()<0.5){ const b=a*x; return {eq:`${a}x = ${b}`, ans:x, hint:'Ø§Ù‚Ø³Ù… Ø§Ù„Ø·Ø±ÙÙŠÙ† Ø¹Ù„Ù‰ Ù†ÙØ³ Ø§Ù„Ø¹Ø¯Ø¯.'}; }
  const b=rnd(1,10); return {eq:`x Ã· ${a} = ${b}`, ans:b*a, hint:'Ø§Ø¶Ø±Ø¨ Ø§Ù„Ø·Ø±ÙÙŠÙ† ÙÙŠ Ù†ÙØ³ Ø§Ù„Ø¹Ø¯Ø¯.'};
}
function gen_ax_plus_b(){ // Ù…ØªÙˆØ³Ø·
  const a=rnd(2,9), x=rnd(-9,12), b=rnd(-9,9); const c=a*x+b;
  const bt=b>=0?`+ ${b}`:`âˆ’ ${Math.abs(b)}`;
  return {eq:`${a}x ${bt} = ${c}`, ans:x, hint:'Ø§Ø¹ÙƒØ³: Ø§Ø·Ø±Ø­/Ø£Ø¶Ù Ø«Ù… Ø§Ù‚Ø³Ù….'};
}
function gen_x_over_a_plus_b(){ // Ù…ØªÙˆØ³Ø·
  const a=rnd(2,9), x=rnd(-18,18), b=rnd(-9,9); const c=x/a+b;
  if(!Number.isInteger(c)) return gen_x_over_a_plus_b();
  const bt=b>=0?`+ ${b}`:`âˆ’ ${Math.abs(b)}`;
  return {eq:`(x Ã· ${a}) ${bt} = ${c}`, ans:x, hint:'Ø§Ø¹ÙƒØ³: Ø§Ø·Ø±Ø­/Ø£Ø¶Ù Ø«Ù… Ø§Ø¶Ø±Ø¨.'};
}
function gen_a_bracket(){ // ØµØ¹Ø¨
  const a=rnd(2,9), x=rnd(-9,12), b=rnd(-5,5); const c=a*(x+b);
  const bt=b>=0?`+ ${b}`:`âˆ’ ${Math.abs(b)}`;
  return {eq:`${a}(x ${bt}) = ${c}`, ans:x, hint:'Ø§Ù‚Ø³Ù… Ø«Ù… Ø§Ø·Ø±Ø­/Ø£Ø¶Ù.'};
}

/* Ø¨Ù†Ø§Ø¡ Ø£Ø³Ø¦Ù„Ø© Ø¨Ø¯ÙˆÙ† ØªÙƒØ±Ø§Ø± ÙˆØ¨ØªØ±ØªÙŠØ¨ Ø³Ù‡Ù„â†’Ù…ØªÙˆØ³Ø·â†’ØµØ¹Ø¨ */
function buildNonRepeating(gen, count, used){
  const list=[];
  while(list.length<count){
    const q=gen();
    if(!used.has(q.eq)){ used.add(q.eq); list.push(q); }
  }
  return list;
}
function buildQuestions(){
  const used=new Set();
  const easy   = [
    ...buildNonRepeating(gen_add_sub, 8, used),
    ...buildNonRepeating(gen_mul_div, 4, used),
  ];
  const medium = [
    ...buildNonRepeating(gen_ax_plus_b, 6, used),
    ...buildNonRepeating(gen_x_over_a_plus_b, 6, used),
  ];
  const hard   = buildNonRepeating(gen_a_bracket, 6, used);
  return [...easy, ...medium, ...hard].slice(0, TOTAL_Q);
}

/* ØªØ´ØºÙŠÙ„ */
let QUESTIONS=[], idx=0, score=0, timeLeft=TIME_LIMIT, timer=null, running=false;

function render(q){
  counterEl.textContent = `${idx+1} / ${TOTAL_Q}`;
  eqEl.textContent      = asEq(q.eq);
  hintEl.textContent    = q.hint || '';
  choicesEl.innerHTML   = '';
  makeChoices(q.ans).forEach(opt=>{
    const b=document.createElement('button');
    b.className='choice'; b.textContent=opt;
    b.onclick=()=>choose(Number(opt), q.ans, b);
    choicesEl.appendChild(b);
  });
}

function choose(sel, ans, btn){
  if(sel===ans){
    btn.classList.add('correct');
    score++; scoreEl.textContent=score;
    setTimeout(()=>{ idx++; if(idx>=TOTAL_Q){ win(); } else { render(QUESTIONS[idx]); } },140);
  }else{
    btn.classList.add('wrong');
    setTimeout(()=>{ window.location.href='index.html'; },140);
  }
}

function start(){
  if(running) return;
  running=true; doneEl.hidden=true;
  QUESTIONS = buildQuestions(); idx=0; score=0; scoreEl.textContent=score;
  timeLeft=TIME_LIMIT; timeEl.textContent=timeLeft;
  render(QUESTIONS[idx]);
  startBtn.disabled=true; startBtn.textContent='Ø¬Ø§Ø±ÙŠâ€¦';
  clearInterval(timer);
  timer=setInterval(()=>{ timeLeft--; timeEl.textContent=timeLeft; if(timeLeft<=0){ clearInterval(timer); window.location.href='index.html'; } },1000);
}

function win(){
  clearInterval(timer);
  eqEl.textContent='Ø§ÙƒØªÙ…Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± âœ…'; hintEl.textContent=''; choicesEl.innerHTML='';
  doneEl.hidden=false; startBtn.disabled=false; startBtn.textContent='Ø¥Ø¹Ø§Ø¯Ø©'; running=false;
}

document.getElementById('startBtn').addEventListener('click', start);
</script>
</body>
</html>
